---
title: "tvseries"
format: html
---

# **TV Series Ratings in Srishti**

This dataset looks at how a few Srishti students rated three popular TV shows: The Big Bang Theory, Modern Family, and Friends. The goal is to get a quick idea of which show seems to be the crowd favorite among Srishti students and whether there are any interesting patterns in their preferences.

------------------------------------------------------------------------

## Data Dictionary

Qualitative Variables

:   -   **Name:** Factor indicating name of the participant.

    -   **gender:** Factor indicating sex. Gender refers to either Male or Female.

    -   **friends:** Numeric indicating the rating for the show "Friends" from 1-10.

    -   **modern_family:** Numeric indicating the rating for the show "Modern Family" from 1-10.

    -   **big_bang_theory:** Numeric indicating the rating for the show "big bang theory" from 1-10.

## Our questions/ assumptions before performing EDA:

-   
-   

------------------------------------------------------------------------

#### Setting up the libraries

```{r}
library(tidyverse)
library(mosaic) # Our go-to package
library(ggformula)
library(infer) # An alternative package for inference using tidy data
library(broom) # Clean test results in tibble form
library(skimr) # data inspection
library(tinytable) # Pretty Tables
library(kableExtra) # Pretty Tables
library(ggprism) # Prism-like ggplot themes
library(resampledata3) # Datasets from Chihara and Hesterberg's book
library(openintro) # datasets
library(infer)
library(vcd)
library(resampledata)
library(openintro)
library(readr)
library(naniar)
library(janitor)
library(DT)
library(crosstable)
library(geofacet)
library(ggplot2)
```

#### Reading The Data
```{r}
Tvseries <- readr::read_delim("~/Downloads/Datasets for A3/tvseries.csv") %>% 
  janitor::clean_names(case = "snake") %>% 
  dplyr::glimpse()

Tvseries
```

#### Inspecting the Data

```{r}
 visdat::vis_dat(Tvseries) + ggtitle(label= "TV Series Ratings: Missing Data", subtitle = "Showing Variable Types")
  visdat::vis_miss(Tvseries)

```
2.3% of the data is missing, We can do away with these.

### Data Munging:

```{r}
Tvseries_mod1 <- Tvseries %>% 
  mutate(across(where(is.character), as.factor)) %>% 
tidyr::drop_na()
Tvseries_mod1
```

```{r}
TVseries_mod2 <- Tvseries_mod1 %>%
  pivot_longer(
    cols = c("friends", "modern_family", "big_bang_theory"),
    names_to = "TVshow",
    values_to = "Rating"
  )

TVseries_mod2

```


```{r}
gf_jitter(Rating ~ TVshow,
  color = ~TVshow, width = 0.2,
  data = TVseries_mod2, size = 3, alpha = 0.5
) %>%
  gf_labs(
    title = "Rating across TV shows",
    x = "TV shows", y = "Ratings"
  ) %>%
  gf_hline(yintercept = ~ mean(Rating), color = "red") %>%
  gf_annotate(geom = "text", label = "Overall Mean", x = 3, y = mean(TVseries_mod2$Rating) + 0.5, size = 4) %>%
  gf_refine(
    scale_x_discrete(guide = "prism_bracket"),
    guides(color = guide_legend(title = "Tv shows"))
  )
```

```{r}
Tvseries_anova <- aov(Rating~ TVshow, data = TVseries_mod2)
Tvseries_anova
```

```{r}
Tvseries_supernova <-
  supernova::pairwise(Tvseries_anova,
    correction = "Bonferroni", # Try "Tukey"
    alpha = 0.05, # 95% CI calculation
    var_equal = TRUE, # We'll see
    plot = T
  )
```

```{r}
Tvseries_supernova$TVshow
```

```{r}
supernova::supernova(Tvseries_anova)
```

##Stating the Anova

```{r}
supernova::equation(Tvseries_anova)
```

```{r}
## Plot the Equation over the Scatterplot
TVseries_mod2 %>%
  mutate(fitted = fitted(Tvseries_anova)) %>%
  gf_jitter(Rating~ TVshow,
    width = 0.2, alpha = 0.6,
    color = ~TVshow,
    data = .
  ) %>%
  gf_summary(
    group = ~1,
    fun = "mean", geom = "line", colour = "lightblue",
    lty = 1, linewidth = 2
  ) %>%
  gf_point(fitted ~ TVshow,
    color = ~TVshow,
    shape = 2,
    size = 6
  ) %>%
  gf_segment(fitted + fitted ~ 0 + TVshow, linetype = 2, color = ~TVshow) %>%

  gf_labs(
    title = "Fitted ANOVA Model Equation",
    x = "Ratings", y = "TVshow"
  ) %>%
  gf_refine(
    guides(colour = guide_legend(title = "TV Shows"))
  ) %>%
  gf_refine(
    scale_x_discrete(guide = "prism_bracket"),
    scale_y_continuous(breaks = c(10, 15, (26.3 - 10.1), 20, (26.3 - 5.3), 25, 26.3, 30, 35))
  )
```

## Checking for ANOVA assumptions

```{r}
shapiro.test(x = TVseries_mod2$Rating)
```

```{r}
TVseries_mod2 %>%
  group_by(TVshow) %>%
  group_modify(~ .x %>%
    select(Rating) %>%
    as_vector() %>%
    shapiro.test() %>%
    broom::tidy())
```

```{r}
Tvseries_anova$residuals %>%
  as_tibble() %>%
  gf_dhistogram(~value, data = .) %>%
  gf_labs(
    title = "Residuals Histogram",
    x = "Residuals", y = "Count"
  ) %>%
  gf_fitdistr()
##
Tvseries_anova$residuals %>%
  as_tibble() %>%
  gf_qq(~value, data = .) %>%
  gf_qqstep() %>%
  gf_labs(
    title = "Residuals Q-Q Plot",
    x = "Theoretical Quantiles", y = "Sample Quantiles"
  ) %>%
  gf_qqline()

```

```{r}
shapiro.test(Tvseries_anova$residuals)

```
