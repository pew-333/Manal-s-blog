{
  "hash": "b892a2eeb48db52e2ef91eb1181c1bf2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"tvseries\"\nformat: html\n---\n\n# **TV Series Ratings in Srishti**\n\nThis dataset looks at how a few Srishti students rated three popular TV shows: The Big Bang Theory, Modern Family, and Friends. The goal is to get a quick idea of which show seems to be the crowd favorite among Srishti students and whether there are any interesting patterns in their preferences.\n\n------------------------------------------------------------------------\n\n## Data Dictionary\n\nQualitative Variables\n\n:   -   **Name:** Factor indicating name of the participant.\n\n    -   **gender:** Factor indicating sex. Gender refers to either Male or Female.\n\n    -   **friends:** Numeric indicating the rating for the show \"Friends\" from 1-10.\n\n    -   **modern_family:** Numeric indicating the rating for the show \"Modern Family\" from 1-10.\n\n    -   **big_bang_theory:** Numeric indicating the rating for the show \"big bang theory\" from 1-10.\n\n## Our questions/ assumptions before performing EDA:\n\n-   \n-   \n\n------------------------------------------------------------------------\n\n#### Setting up the libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic) # Our go-to package\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula)\nlibrary(infer) # An alternative package for inference using tidy data\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'infer'\n\nThe following objects are masked from 'package:mosaic':\n\n    prop_test, t_test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(broom) # Clean test results in tibble form\nlibrary(skimr) # data inspection\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tinytable) # Pretty Tables\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'tinytable'\n\nThe following object is masked from 'package:ggplot2':\n\n    theme_void\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(kableExtra) # Pretty Tables\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'kableExtra'\n\nThe following object is masked from 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggprism) # Prism-like ggplot themes\nlibrary(resampledata3) # Datasets from Chihara and Hesterberg's book\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'resampledata3'\n\nThe following object is masked from 'package:datasets':\n\n    Titanic\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(openintro) # datasets\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n\nAttaching package: 'openintro'\n\nThe following object is masked from 'package:mosaic':\n\n    dotPlot\n\nThe following objects are masked from 'package:lattice':\n\n    ethanol, lsegments\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(infer)\nlibrary(vcd)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: grid\n\nAttaching package: 'vcd'\n\nThe following object is masked from 'package:mosaic':\n\n    mplot\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(resampledata)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'resampledata'\n\nThe following objects are masked from 'package:resampledata3':\n\n    Bushmeat, ChiMarathonMen, Cuckoos, FlightDelays, Groceries,\n    IceCream, MobileAds, NCBirths2004, Olympics2012, Phillies2009,\n    Recidivism\n\nThe following object is masked from 'package:datasets':\n\n    Titanic\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(openintro)\nlibrary(readr)\nlibrary(naniar)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'naniar'\n\nThe following object is masked from 'package:skimr':\n\n    n_complete\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DT)\nlibrary(crosstable)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'crosstable'\n\nThe following object is masked from 'package:purrr':\n\n    compact\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(geofacet)\nlibrary(ggplot2)\n```\n:::\n\n\n#### Reading The Data\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries <- readr::read_delim(\"~/Downloads/Datasets for A3/tvseries.csv\") %>% \n  janitor::clean_names(case = \"snake\") %>% \n  dplyr::glimpse()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 52 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): Name, Gender\ndbl (3): Friends, Modern Family, Big Bang Theory\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 52\nColumns: 5\n$ name            <chr> \"Diya\", \"Ihina\", \"Abhinav\", \"Nikhita\", \"Rishi\", \"Charv…\n$ gender          <chr> \"Female\", \"Female\", \"Male\", \"Female\", \"Male\", \"Female\"…\n$ friends         <dbl> 8.0, 7.0, 8.0, 7.0, 8.0, 6.0, 8.0, 4.0, 9.0, 7.0, NA, …\n$ modern_family   <dbl> 9.0, 9.0, 10.0, 9.0, 6.0, 9.0, 7.5, 8.0, 8.0, 9.0, 9.5…\n$ big_bang_theory <dbl> 9.0, 6.0, 7.0, 6.0, 5.0, 5.5, 9.0, 6.0, 5.0, 3.0, 6.0,…\n```\n\n\n:::\n\n```{.r .cell-code}\nTvseries\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 52 × 5\n   name    gender friends modern_family big_bang_theory\n   <chr>   <chr>    <dbl>         <dbl>           <dbl>\n 1 Diya    Female       8           9               9  \n 2 Ihina   Female       7           9               6  \n 3 Abhinav Male         8          10               7  \n 4 Nikhita Female       7           9               6  \n 5 Rishi   Male         8           6               5  \n 6 Charvi  Female       6           9               5.5\n 7 Maya    Female       8           7.5             9  \n 8 Anuva   Female       4           8               6  \n 9 Shourya Male         9           8               5  \n10 sarthak Male         7           9               3  \n# ℹ 42 more rows\n```\n\n\n:::\n:::\n\n\n#### Inspecting the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n visdat::vis_dat(Tvseries) + ggtitle(label= \"TV Series Ratings: Missing Data\", subtitle = \"Showing Variable Types\")\n```\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  visdat::vis_miss(Tvseries)\n```\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n2.3% of the data is missing, We can do away with these.\n\n### Data Munging:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries_mod1 <- Tvseries %>% \n  mutate(across(where(is.character), as.factor)) %>% \ntidyr::drop_na()\nTvseries_mod1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 46 × 5\n   name    gender friends modern_family big_bang_theory\n   <fct>   <fct>    <dbl>         <dbl>           <dbl>\n 1 Diya    Female       8           9               9  \n 2 Ihina   Female       7           9               6  \n 3 Abhinav Male         8          10               7  \n 4 Nikhita Female       7           9               6  \n 5 Rishi   Male         8           6               5  \n 6 Charvi  Female       6           9               5.5\n 7 Maya    Female       8           7.5             9  \n 8 Anuva   Female       4           8               6  \n 9 Shourya Male         9           8               5  \n10 sarthak Male         7           9               3  \n# ℹ 36 more rows\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTVseries_mod2 <- Tvseries_mod1 %>%\n  pivot_longer(\n    cols = c(\"friends\", \"modern_family\", \"big_bang_theory\"),\n    names_to = \"TVshow\",\n    values_to = \"Rating\"\n  )\n\nTVseries_mod2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 138 × 4\n   name    gender TVshow          Rating\n   <fct>   <fct>  <chr>            <dbl>\n 1 Diya    Female friends              8\n 2 Diya    Female modern_family        9\n 3 Diya    Female big_bang_theory      9\n 4 Ihina   Female friends              7\n 5 Ihina   Female modern_family        9\n 6 Ihina   Female big_bang_theory      6\n 7 Abhinav Male   friends              8\n 8 Abhinav Male   modern_family       10\n 9 Abhinav Male   big_bang_theory      7\n10 Nikhita Female friends              7\n# ℹ 128 more rows\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_jitter(Rating ~ TVshow,\n  color = ~TVshow, width = 0.2,\n  data = TVseries_mod2, size = 3, alpha = 0.5\n) %>%\n  gf_labs(\n    title = \"Rating across TV shows\",\n    x = \"TV shows\", y = \"Ratings\"\n  ) %>%\n  gf_hline(yintercept = ~ mean(Rating), color = \"red\") %>%\n  gf_annotate(geom = \"text\", label = \"Overall Mean\", x = 3, y = mean(TVseries_mod2$Rating) + 0.5, size = 4) %>%\n  gf_refine(\n    scale_x_discrete(guide = \"prism_bracket\"),\n    guides(color = guide_legend(title = \"Tv shows\"))\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The S3 guide system was deprecated in ggplot2 3.5.0.\nℹ It has been replaced by a ggproto system that can be extended.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries_anova <- aov(Rating~ TVshow, data = TVseries_mod2)\nTvseries_anova\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = Rating ~ TVshow, data = TVseries_mod2)\n\nTerms:\n                  TVshow Residuals\nSum of Squares   86.6341  472.8098\nDeg. of Freedom        2       135\n\nResidual standard error: 1.871442\nEstimated effects may be unbalanced\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries_supernova <-\n  supernova::pairwise(Tvseries_anova,\n    correction = \"Bonferroni\", # Try \"Tukey\"\n    alpha = 0.05, # 95% CI calculation\n    var_equal = TRUE, # We'll see\n    plot = T\n  )\n```\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries_supernova$TVshow\n```\n\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTVshow\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLevels: 3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nFamily-wise error-rate: 0.049\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  group_1       group_2          diff pooled_se     t    df  lower upper p_adj\n  <chr>         <chr>           <dbl>     <dbl> <dbl> <int>  <dbl> <dbl> <dbl>\n1 friends       big_bang_theory 0.446     0.276 1.615   135 -0.148 1.039 .3259\n2 modern_family big_bang_theory 1.859     0.276 6.736   135  1.265 2.452 .0000\n3 modern_family friends         1.413     0.276 5.121   135  0.820 2.006 .0000\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsupernova::supernova(Tvseries_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Analysis of Variance Table (Type III SS)\n Model: Rating ~ TVshow\n\n                              SS  df     MS      F   PRE     p\n ----- --------------- | ------- --- ------ ------ ----- -----\n Model (error reduced) |  86.634   2 43.317 12.368 .1549 .0000\n Error (from model)    | 472.810 135  3.502                   \n ----- --------------- | ------- --- ------ ------ ----- -----\n Total (empty model)   | 559.444 137  4.084                   \n```\n\n\n:::\n:::\n\n\n##Stating the Anova\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsupernova::equation(Tvseries_anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFitted equation:\nRating = 6.445652 + 0.4456522*TVshowfriends + 1.858696*TVshowmodern_family + e\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Plot the Equation over the Scatterplot\nTVseries_mod2 %>%\n  mutate(fitted = fitted(Tvseries_anova)) %>%\n  gf_jitter(Rating~ TVshow,\n    width = 0.2, alpha = 0.6,\n    color = ~TVshow,\n    data = .\n  ) %>%\n  gf_summary(\n    group = ~1,\n    fun = \"mean\", geom = \"line\", colour = \"lightblue\",\n    lty = 1, linewidth = 2\n  ) %>%\n  gf_point(fitted ~ TVshow,\n    color = ~TVshow,\n    shape = 2,\n    size = 6\n  ) %>%\n  gf_segment(fitted + fitted ~ 0 + TVshow, linetype = 2, color = ~TVshow) %>%\n\n  gf_labs(\n    title = \"Fitted ANOVA Model Equation\",\n    x = \"Ratings\", y = \"TVshow\"\n  ) %>%\n  gf_refine(\n    guides(colour = guide_legend(title = \"TV Shows\"))\n  ) %>%\n  gf_refine(\n    scale_x_discrete(guide = \"prism_bracket\"),\n    scale_y_continuous(breaks = c(10, 15, (26.3 - 10.1), 20, (26.3 - 5.3), 25, 26.3, 30, 35))\n  )\n```\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Checking for ANOVA assumptions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(x = TVseries_mod2$Rating)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  TVseries_mod2$Rating\nW = 0.91645, p-value = 3.301e-07\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTVseries_mod2 %>%\n  group_by(TVshow) %>%\n  group_modify(~ .x %>%\n    select(Rating) %>%\n    as_vector() %>%\n    shapiro.test() %>%\n    broom::tidy())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n# Groups:   TVshow [3]\n  TVshow          statistic    p.value method                     \n  <chr>               <dbl>      <dbl> <chr>                      \n1 big_bang_theory     0.946 0.0320     Shapiro-Wilk normality test\n2 friends             0.909 0.00161    Shapiro-Wilk normality test\n3 modern_family       0.808 0.00000294 Shapiro-Wilk normality test\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTvseries_anova$residuals %>%\n  as_tibble() %>%\n  gf_dhistogram(~value, data = .) %>%\n  gf_labs(\n    title = \"Residuals Histogram\",\n    x = \"Residuals\", y = \"Count\"\n  ) %>%\n  gf_fitdistr()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##\nTvseries_anova$residuals %>%\n  as_tibble() %>%\n  gf_qq(~value, data = .) %>%\n  gf_qqstep() %>%\n  gf_labs(\n    title = \"Residuals Q-Q Plot\",\n    x = \"Theoretical Quantiles\", y = \"Sample Quantiles\"\n  ) %>%\n  gf_qqline()\n```\n\n::: {.cell-output-display}\n![](tvseries_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(Tvseries_anova$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Tvseries_anova$residuals\nW = 0.93715, p-value = 7.456e-06\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "tvseries_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}