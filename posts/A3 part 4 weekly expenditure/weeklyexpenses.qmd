---
title: "A3 part 4: weekly expenditure"
format: html
---

# **Diwali Week Expenditure Analysis of Srishti Students**

This dataset captures the spending patterns of Srishti students during Diwali week.

------------------------------------------------------------------------

## Data Dictionary

Qualitative Variables

:   -   **Name:** Factor indicating name of the participant.

    -   **gender:** Factor indicating sex. Gender refers to either Male or Female.

    -   **total_expenditure_last_week:** Numeric indicating total amount spent by the student during Diwali week, measured in Indian Rupees (₹),

## Our questions/ assumptions before performing EDA:

-   Would there be a significant difference in average expenditure between male and female students during Diwali week?
-   Student allowances/ income are typically modest, so less than 20% of students spend more than ₹5,000 during Diwali week.

------------------------------------------------------------------------

#### Setting up the libraries

```{r}
library(tidyverse)
library(mosaic) # Our go-to package
library(ggformula)
library(infer) # An alternative package for inference using tidy data
library(broom) # Clean test results in tibble form
library(skimr) # data inspection
library(tinytable) # Pretty Tables
library(kableExtra) # Pretty Tables
library(ggprism) # Prism-like ggplot themes
library(resampledata3) # Datasets from Chihara and Hesterberg's book
library(openintro) # datasets
library(infer)
library(vcd)
library(resampledata)
library(openintro)
library(readr)
library(naniar)
library(janitor)
library(DT)
library(crosstable)
library(geofacet)
library(ggplot2)
```

#### Reading The Data

```{r}
Weeklyexp <- readr::read_delim("~/Documents/irritating Class FOSEDA/Manal's blog/posts/data/weeklyexpense.csv") %>% 
  janitor::clean_names(case = "snake") %>% 
  dplyr::glimpse()

Weeklyexp
```

#### Inspecting the Data

```{r}
 visdat::vis_dat(Weeklyexp) + ggtitle(label= "Weekly expenditure: Missing Data", subtitle = "Showing Variable Types")
  visdat::vis_miss(Weeklyexp)
```

#### Data Munging:

There are a few extra columns named "x4", "x5" and "x6"; let us remove those:

```{r}
Weeklyexp1 <- Weeklyexp %>% 
  select(-c(x4, x5, x6)) %>% 
  
    mutate(across(where(is.character), as.factor)) %>% 
  tidyr::drop_na()
Weeklyexp1
```

```{r}
Weeklyexp1 %>% 
gf_histogram(~total_expenditure_last_week) %>% 
  gf_facet_grid(~gender) %>% 
  gf_labs( title= "Distribution of expenditure among sristhi students by gender", subtitle="During the week of Diwali")
```

Both male and female distributions are heavily right-skewed, meaning most students spend relatively little, but a few extreme high spenders pull the average upward. The median will be much lower than the mean for both groups. Females seem to portray comparatively consistent and moderate spending behavior, in contrast to males, showing more diverse spending behaviors.

```{r}
Weeklyexp1 %>% 
gf_boxplot(gender~total_expenditure_last_week, orientation = "y") %>% 
  gf_labs(title="Distribution of expenditure by Srishti Students",
          subtitle="During the week of Diwali")
```

Through this boxplot, we understand that males on average spent more during diwali than females in srishti.

```{r}
Weeklyexp1 %>% 
gf_violin(gender  ~ total_expenditure_last_week, fill = ~gender) %>% 
  gf_labs(title="Distribution of expenditure by Srishti Students",
          subtitle="During the week of Diwali")
```

For female students, we see the highest density at approximately ₹1,000-₹2,000. We also see very few students beyond ₹5,000.

For male students,primary density peak at ₹2,000-₹4,000. But the distribution is flatter, meaning that the density is more spread out. Multiple smaller peaks suggest different spending subgroups:

-   Budget spenders (₹0-₹5K) - majority

-   Moderate spenders (₹10-15K) - small group

-   High spenders (₹20-25K) - few individuals

-   Extreme spenders (₹50K+) - rare cases

------------------------------------------------------------------------

## Is data normally distributed??

```{r}
Weeklyexp1%>% 
  gf_density(~total_expenditure_last_week) %>%
  gf_fitdistr(dist = "dnorm") %>%
  gf_labs(
    title = "Density of Total expenditure",
    subtitle = "Compared with Normal Density"
  )

```

The data is far from the normality curve. This is a severe violation of the normality assumptions. Most students spend very little, but the few high spenders are SO extreme that they pull the theoretical normal distribution way to the right, making it completely misaligned with reality.

```{r}
stats::shapiro.test(x = Weeklyexp1$total_expenditure_last_week) %>%
  broom::tidy()

```

Since the p.value is EXTREMELY small, we should reject the null hypothesis that the data follows a normal distribution.

We ideally should not be running a t-test because of the above reasons:

```{r}
t4 <- mosaic::t_test(
  Weeklyexp1$total_expenditure_last_week, # Name of variable
  mu = 2000, # belief
  alternative = "two.sided"
) %>% # Check both sides
  broom::tidy()
t4

```

------------------------------------------------------------------------

### Conclusion:

The data shows that Srishti students’ Diwali week spending is highly right-skewed, with most spending modest amounts and a few outliers spending very large sums. Males generally spent more than females, but the variation within the male group is much higher. The distribution clearly violates normality assumptions, as confirmed by the Shapiro–Wilk test.
